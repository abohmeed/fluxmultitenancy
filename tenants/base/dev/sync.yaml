---
apiVersion: v1
kind: Secret
metadata:
    name: gitlab-auth
    namespace: apps
stringData:
    password: ENC[AES256_GCM,data:7QGhdnaYWuE2huHLnUj3ZiAZOj7jXrXTJMg=,iv:T5Zya5M1fUY9A4MCBdUMcYuCzwh3+atgFZTUPK6Owyc=,tag:zqnNImExbpzKUZpqZLyUow==,type:str]
    username: ENC[AES256_GCM,data:Syksc4CFoCUcKjmNnfGH5SW0,iv:MXwiAe2pF52HPPIMPDCLBRHXxZZ8zcvbMpyzbj9H9w8=,tag:zIjuWUqQbjiC4Rpyj1FsIw==,type:str]
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age: []
    lastmodified: "2023-10-29T10:00:53Z"
    mac: ENC[AES256_GCM,data:J4aBvXSArMTYFgIpjs8LCGXS4xkMi+ZtRG6kbNgTWAbfZZ4WbyVEt1Jz0T9Gr61YMLH2NxiP3EFOoP2XsmGoBbFF3O3eX+9PSSaU8U7r2EbHWwiVMynD50FMeMHtZ9SPOW8eMDgF+tdP8jbOasXJUkT5eM0G8LokzRGhod3F7jU=,iv:WCzA302wBrweGv+uH36ePcz0BZXLqXnrWh5XKOgAW+4=,tag:IRgCUQlGZpnbtsAGdJvG3Q==,type:str]
    pgp:
        - created_at: "2023-10-29T10:00:53Z"
          enc: |
            -----BEGIN PGP MESSAGE-----

            hQIMAx546Ghm4HPxAQ//R+VMmlM9rT1Lh1mccedj8ZwRa1nARAdhYam3ygZgxm4w
            CDmrx6RTR+ldM9fTBl7dPJCFVoFMhNM+wKxtaMm1D/gWrXF9I0dYrTBPo/OEQBJT
            e1fiEfwSZ9KlSupM/kdZZT6NJu3aBe2zo5nUfoJO5THrbeUIfv81SfxCg672NQzm
            xm8Oyz9JADS05CCVyxAVEcya4hqMRUjc1LBCftxDH0nzTr5aw72RtDW6czhfpeQa
            9LYjhiS4qQLGaq7IcRL4eVQD00aapXtFsqxaoFbaBywX6xzECM/Cu0yE822paKjH
            7xp630sPymauU1dEKwaENFUR2tedONQv0yhl1ZltUsEnKpQ/KU76Rkr4Reues+1H
            0BjK/2MOQ9PmoMjWxaVj7H+YZU+ER3JsLR0vejnmlFWNuyBPNdSCXlKY2CPeX9Rx
            n+BfkcWU/bS8pH0K3w7oyE9MlHI+biPstbxo/rArPLGR297T+rHH20xwalBRnb58
            RAQp6ShyuKx61VFpFruxmRKAzRa5w+DFnQ4tDIpoDLS7KTO4TKInC/bFghRZthrk
            WXj1KCO4tmRSFajqXvN4cBFVe3Gu4/2bPzDMyVWa244zU5IkWTVJTmOqSUj2l2cS
            rUSaY4AR9QfitPOc5w1xAYstDzuAqHXeQq0fNJddgmx9Mb8E/xtDd/cgm4VbqD3S
            XgEw/d8oK+eAIbqidK2Wu0T3v40nEtrxl/lDOp9CO4UJDHcfVbOjbM41oGbgKCZd
            xKZzvlVBcl2uJTJY+P30kY0+Sfnr1aXla9fPNmulsZatZCNg7IKba+W33JSiMEg=
            =hYps
            -----END PGP MESSAGE-----
          fp: 99F6DD21668C977FA0E35AB64C928FA9E7FF041B
    encrypted_regex: ^(data|stringData)$
    version: 3.7.3
---
apiVersion: source.toolkit.fluxcd.io/v1
kind: GitRepository
metadata:
  name: dev
  namespace: apps
spec:
  interval: 1m0s
  ref:
    branch: main
  secretRef:
    name: gitlab-auth
  url: https://gitlab.com/abohmeed/myweatherapp
---
apiVersion: source.toolkit.fluxcd.io/v1beta2
kind: HelmRepository
metadata:
  name: gitlab
  namespace: apps
spec:
  interval: 1m0s
  secretRef:
    name: gitlab-auth
  type: oci
  url: oci://registry.gitlab.com/abohmeed/myweatherapp
---
apiVersion: kustomize.toolkit.fluxcd.io/v1
kind: Kustomization
metadata:
  name: dev
  namespace: apps
spec:
  decryption:
    provider: sops
    secretRef:
      name: sops-hcvault
  interval: 1m0s
  path: ./
  prune: false
  serviceAccountName: dev
  sourceRef:
    kind: GitRepository
    name: dev
